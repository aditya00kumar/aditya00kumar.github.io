---
layout: post
title: "Wilson Lower bound score for K scale ratings"
categories:
  - Research Paper
tags:
  - Machine learning
excerpt_separator:  <!--more-->
last_modified_at: 2017-03-09T14:25:52-05:00
---
[How not to sort](http://www.evanmiller.org/how-not-to-sort-by-average-rating.html) 

<img src="https://latex.codecogs.com/png.latex?\fn_phv&space;$$S(n_1,&space;\ldots,&space;n_k)&space;=&space;\sum_{k=1}^K{s_k&space;\frac{n_k&space;&plus;&space;1}{N&space;&plus;&space;K}}&space;-&space;z_{\alpha/2}&space;\sqrt{\left(\left(\sum_{k=1}^K&space;s_k^2&space;\frac{n_k&space;&plus;&space;1}{N&space;&plus;&space;K}\right)&space;-&space;\left(\sum_{k=1}^K{s_k&space;\frac{n_k&space;&plus;&space;1}{N&space;&plus;&space;K}}\right)^2\right)/(N&space;&plus;&space;K&space;&plus;&space;1)}$$" title="$$S(n_1, \ldots, n_k) = \sum_{k=1}^K{s_k \frac{n_k + 1}{N + K}} - z_{\alpha/2} \sqrt{\left(\left(\sum_{k=1}^K s_k^2 \frac{n_k + 1}{N + K}\right) - \left(\sum_{k=1}^K{s_k \frac{n_k + 1}{N + K}}\right)^2\right)/(N + K + 1)}$$" />

```python
import math
import scipy.stats as st
def rating_products(n, confidence):
    K = len(n)
    z = st.norm.ppf(1 - (1 - confidence) / 2)
    N = sum(n)
    first_part=0.0
    second_part=0.0
    for k, n_k in enumerate(n):
        first_part += (k+1)*(n[k]+1)/(N+K)
        second_part += (k+1)*(k+1)*(n[k]+1)/(N+K)
    score = first_part - z* math.sqrt((second_part - first_part*first_part)/(N+K+1))
    return score
```

